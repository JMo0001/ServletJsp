<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>카페 포스기</title>
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <!-- <link href="/html/20230619_HTML/resources/css/reset.css" rel="stylesheet"> -->
    <!--style 지정 - 각자 실습 -->
    <!---->
    <script>
        $(loadedHandler);
        function loadedHandler(){
            //이벤트 등록
            // $('.c').on('blur', cntBlurHandler);
            $("[type=button]").on("click", calcClickHandler);
        }
        
        //각종 기능 함수들
        function cntBlurHandler(event){
            // console.log(this);
            // console.log(event.target);  // event.target = this
            console.log(event);
            //각자 실습 
            // console.log($(this).parent().prev().text());
            // console.log(this.value); jQuery는 메소드로 되어있음. val()
            console.log($(this).val());
            //메뉴마다 합계 가격
            $(this).parent().next().children('input.p').val(
                $(this).parent().prev().text()
                *
                $(this).val()   // 아래쪽 function의 this와 무관
            );
            updateTotal();
            
            
            // //합계   (아래쪽 함수로 뺌.(blur,click 기능이 같음))
            // var sum = 0;
            // $(".c.in").each(function(idx, item){
            //     /*
            //     합계 >> each 함수
            //     each >> for문을 대신함. event에 handler를 등록함
            //     handler를 붙여서 잘 사용하지 않음. 
            //     each function 에서의 this 사용시 위 this와 헷갈림. */
            //     //item = this
            //     console.log(item);
            //     console.log(typeof($(item).val()));

            //     // if(idx != $(".c").length-1){
            //         var i =$(item).val()*1; //Number 대신 *1로 숫자형태 변경
            //         if (isNaN(i)){
            //             i=0;
            //         }
            //         sum+=i;
            //     // }
            // });   
            // /*
            // $(".c").each(function cTotalCntHandler(idx){
            //     console.log(price);
            //     sum += Number($(this).val());
            // });
            // $(".c").each(cTotalCntHandler); */
            // console.log(sum);
            // $("#cTotalCnt").val(sum);

            // sum=0
            // $(".p").each(function(idx, item){
                
            //     console.log(item);
            //     console.log(typeof($(item).val()));

            //     if(idx != $(".c").length-1){
            //         var i = Number($(item).val());
            //         if (isNaN(i)){
            //             i=0;
            //         }
            //         sum+=i;
            //     }

            // });
            // console.log(sum);
            // $("#cTotalPrice").val(sum);
            
        }
        function calcClickHandler(event){
            // console.log(this);
            // console.log(event.target);      // event.target = this
            // console.log(event);
            //각자 실습

            $(".c.in").each(function(idx, item){
                console.log(item);
                $(item).parent().next().children('input.p').val(
                    $(item).parent().prev().text()
                    *
                    $(item).val()   
                );
            });
            updateTotal();
            
            
        }

        function updateTotal(){
            var sum = 0;
            $(".c.in").each(function(idx, item){
                console.log(item);
                console.log(typeof($(item).val()));
                    var i =$(item).val()*1; //Number 대신 *1로 숫자형태 변경
                    if (isNaN(i)){
                        i=0;
                    }
                    sum+=i;
            });   
            console.log(sum);
            $("#cTotalCnt").val(sum);
            sum=0
            $(".p").each(function(idx, item){
                console.log(item);
                console.log(typeof($(item).val()));
                if(idx != $(".c").length-1){
                    var i = Number($(item).val());
                    if (isNaN(i)){
                        i=0;
                    }
                    sum+=i;
                }
            });
            console.log(sum);
            $("#cTotalPrice").val(sum);
        }       

    </script>
</head>
<body>
    <form action="">
        <table border="1">
            <tr>
                <th>메뉴</th>
                <th>가격</th>
                <th>수량</th>
                <th>합계</th>
            </tr>
            <tr>
                <td>아메리카노</td>
                <td>2500</td>
                <td><input type="text" name="c1" class="c in"></td>
                <td><input type="text" name="c1Price" class="p" readonly></td>
            </tr>
            <tr>
                <td>라떼</td>
                <td>3000</td>
                <td><input type="text" name="c2" class="c in"></td>
                <td><input type="text" name="c2Price" class="p" readonly></td>
            </tr>
            <tr>
                <td>생강라떼</td>
                <td>4500</td>
                <td><input type="text" name="c3" class="c in"></td>
                <td><input type="text" name="c3Price" class="p" readonly></td>
            </tr>
            <tr>
                <td>딸기바나나라떼</td>
                <td>4500</td>
                <td><input type="text" name="c4" class="c in"></td>
                <td><input type="text" name="c4Price" class="p" readonly></td>
            </tr>
            <tr>
                <th>합계</th>
                <th></th>
                <th><input type="text" name="cTotalCnt" id="cTotalCnt" class="c" readonly></th>
                <th><input type="text" name="cTotalPrice" id="cTotalPrice" class="p" readonly></th>
            </tr>
            <tr>
                <td colspan="4">
                    <input type="button" value="계산하기">
                    <input type="reset" >
                </td>
            </tr>
        </table>
    </form>
</body>
</html>


